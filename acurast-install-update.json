{
  "id": "script-1769006048943",
  "name": "Exported Python Script",
  "description": "Python script exported from Cellhasher Script Creator",
  "category": "Custom",
  "type": "Python",
  "version": "1.0.0",
  "author": "Cellhasher User",
  "tags": [
    "python",
    "exported"
  ],
  "effects": {
    "power": {
      "reboot": false,
      "shutdown": false
    },
    "security": {
      "modifiesLockScreen": false
    }
  },
  "preRunNotice": "This Python script was exported from Cellhasher Script Creator.",
  "pythonScript": "#!/usr/bin/env python3\nimport os\nimport sys\nimport subprocess\nimport tempfile\nimport urllib.request\nimport json\nimport ssl\nfrom concurrent.futures import ThreadPoolExecutor, as_completed\n\n# ---------------------------------------------------------------------\n# Windows console encoding fix\n# ---------------------------------------------------------------------\nif sys.platform == 'win32':\n    try:\n        sys.stdout.reconfigure(encoding='utf-8', errors='replace')\n        sys.stderr.reconfigure(encoding='utf-8', errors='replace')\n    except Exception:\n        pass\n\n# ---------------------------------------------------------------------\n# Environment variables (Cellhasher)\n# ---------------------------------------------------------------------\nADB = os.environ.get(\"adb_path\", \"adb\")\ndevices = os.environ.get(\"devices\", \"\").split()\n\n# ---------------------------------------------------------------------\n# GitHub API\n# ---------------------------------------------------------------------\nGITHUB_API_URL = \"https://api.github.com/repos/Acurast/acurast-processor-update/releases/latest\"\n\n# ---------------------------------------------------------------------\n# SSL setup\n# ---------------------------------------------------------------------\ndef setup_ssl_context():\n    try:\n        if hasattr(ssl, \"_create_unverified_context\"):\n            print(\"[✓] SSL: Using unverified context\")\n            return ssl._create_unverified_context()\n        print(\"[✓] SSL: Using default context\")\n        return ssl.create_default_context()\n    except Exception as e:\n        print(f\"[!] SSL warning: {e}\")\n        return None\n\n# ---------------------------------------------------------------------\n# Fetch latest STABLE processor-lite APK\n# ---------------------------------------------------------------------\ndef get_latest_acurast_lite_apk():\n    print(\"[*] Fetching latest Acurast Lite release info...\")\n\n    ssl_context = setup_ssl_context()\n    req = urllib.request.Request(\n        GITHUB_API_URL,\n        headers={\"User-Agent\": \"Cellhasher-Acurast-Updater/1.0\"}\n    )\n\n    if ssl_context:\n        with urllib.request.urlopen(req, timeout=30, context=ssl_context) as resp:\n            release_data = json.loads(resp.read().decode())\n    else:\n        with urllib.request.urlopen(req, timeout=30) as resp:\n            release_data = json.loads(resp.read().decode())\n\n    print(f\"[✓] Latest release tag: {release_data.get('tag_name')}\")\n\n    selected_asset = None\n\n    for asset in release_data.get(\"assets\", []):\n        name = asset[\"name\"].lower()\n        if (\n            name.startswith(\"processor-lite-\")\n            and name.endswith(\".apk\")\n            and \"canary\" not in name\n            and \"devnet\" not in name\n        ):\n            selected_asset = asset\n            break\n\n    if not selected_asset:\n        raise RuntimeError(\"Stable processor-lite APK not found in release assets\")\n\n    print(f\"[✓] Selected STABLE Lite APK: {selected_asset['name']}\")\n    return selected_asset[\"browser_download_url\"], selected_asset[\"name\"]\n\n# ---------------------------------------------------------------------\n# Download APK\n# ---------------------------------------------------------------------\ndef download_apk(url, name):\n    temp_path = os.path.join(tempfile.gettempdir(), name)\n    print(f\"[*] Downloading {name}\")\n    print(f\"[*] Saving to {temp_path}\")\n\n    req = urllib.request.Request(url, headers={\"User-Agent\": \"Cellhasher-Acurast-Updater/1.0\"})\n    with urllib.request.urlopen(req, timeout=60) as resp, open(temp_path, \"wb\") as f:\n        while True:\n            chunk = resp.read(8192)\n            if not chunk:\n                break\n            f.write(chunk)\n\n    size_mb = os.path.getsize(temp_path) / (1024 * 1024)\n    print(f\"[✓] Download complete ({size_mb:.2f} MB)\")\n    return temp_path\n\n# ---------------------------------------------------------------------\n# Install APK\n# ---------------------------------------------------------------------\ndef install_apk(device, apk_path):\n    try:\n        print(f\"[{device}] Installing Acurast Lite...\")\n        result = subprocess.run(\n            f'\"{ADB}\" -s {device} install -r \"{apk_path}\"',\n            shell=True,\n            capture_output=True,\n            text=True\n        )\n\n        if result.returncode == 0 or \"Success\" in result.stdout:\n            print(f\"[{device}] ✓ Installed successfully\")\n            return f\"[{device}] SUCCESS\"\n        else:\n            msg = result.stderr or result.stdout\n            print(f\"[{device}] ✗ Install failed: {msg}\")\n            return f\"[{device}] FAILED\"\n\n    except Exception as e:\n        return f\"[{device}] ERROR: {e}\"\n\n# ---------------------------------------------------------------------\n# Main\n# ---------------------------------------------------------------------\ndef main():\n    print(\"=\" * 60)\n    print(\"     Acurast Lite – Stable Installer (Production)\")\n    print(\"=\" * 60)\n\n    if not devices or devices == [\"\"]:\n        print(\"[✗] No devices selected\")\n        return\n\n    print(f\"[*] Devices: {len(devices)}\")\n    for i, d in enumerate(devices, 1):\n        print(f\"  {i}. {d}\")\n\n    try:\n        apk_url, apk_name = get_latest_acurast_lite_apk()\n        apk_path = download_apk(apk_url, apk_name)\n\n        print(\"\\n[*] Installing on devices...\\n\")\n\n        with ThreadPoolExecutor(max_workers=len(devices)) as pool:\n            futures = [\n                pool.submit(install_apk, d, apk_path)\n                for d in devices\n            ]\n            for f in as_completed(futures):\n                print(f.result())\n\n        print(\"\\n[*] Cleaning up...\")\n        if os.path.exists(apk_path):\n            os.remove(apk_path)\n\n        print(\"\\n[✓] Acurast Lite stable install complete!\")\n\n    except Exception as e:\n        print(f\"[✗] Script failed: {e}\")\n\nif __name__ == \"__main__\":\n    main()"
}