{
  "id": "script-1769634200343",
  "name": "Acurast Lite auto Update/Install",
  "description": "Install or Update Automatically to the Latest Acurast Lite Mainnet APK",
  "category": "Custom",
  "type": "Python",
  "version": "1.0.0",
  "author": "Cellhasher Team",
  "tags": [
    "python",
    "exported"
  ],
  "effects": {
    "power": {
      "reboot": false,
      "shutdown": false
    },
    "security": {
      "modifiesLockScreen": false
    }
  },
  "preRunNotice": "This Python script was exported from Cellhasher Script Creator.",
  "pythonScript": "#!/usr/bin/env python3\r\nimport os\r\nimport sys\r\nimport subprocess\r\nimport tempfile\r\nimport urllib.request\r\nimport json\r\nimport ssl\r\nfrom concurrent.futures import ThreadPoolExecutor, as_completed\r\n\r\n# Windows console encoding fix\r\nif sys.platform == 'win32':\r\n    try:\r\n        sys.stdout.reconfigure(encoding='utf-8', errors='replace')\r\n        sys.stderr.reconfigure(encoding='utf-8', errors='replace')\r\n    except Exception:\r\n        pass\r\n\r\n# Windows subprocess flags\r\nCREATE_NO_WINDOW = 0x08000000 if sys.platform == 'win32' else 0\r\n\r\n# Environment variables\r\nADB = os.environ.get(\"adb_path\", \"adb\")\r\ndevices = os.environ.get(\"devices\", \"\").split()\r\n\r\n# GitHub API\r\nGITHUB_API_URL = \"https://api.github.com/repos/Acurast/acurast-processor-update/releases/latest\"\r\n\r\n# Global SSL context - create once, use everywhere\r\nSSL_CONTEXT = None\r\n\r\ndef get_ssl_context():\r\n    \"\"\"Get or create SSL context that bypasses certificate verification\"\"\"\r\n    global SSL_CONTEXT\r\n    if SSL_CONTEXT is None:\r\n        try:\r\n            # Try unverified context first (works on most systems)\r\n            SSL_CONTEXT = ssl._create_unverified_context()\r\n            print(\"[*] SSL: Using unverified context\")\r\n        except AttributeError:\r\n            # Fallback to default\r\n            SSL_CONTEXT = ssl.create_default_context()\r\n            print(\"[*] SSL: Using default context\")\r\n    return SSL_CONTEXT\r\n\r\ndef fetch_url(url, timeout=60):\r\n    \"\"\"Fetch URL with proper SSL context\"\"\"\r\n    req = urllib.request.Request(url, headers={\"User-Agent\": \"Cellhasher-Acurast-Updater/1.0\"})\r\n    ctx = get_ssl_context()\r\n    return urllib.request.urlopen(req, timeout=timeout, context=ctx)\r\n\r\ndef get_latest_acurast_lite_apk():\r\n    print(\"[*] Fetching latest Acurast Lite release info...\")\r\n\r\n    with fetch_url(GITHUB_API_URL, timeout=30) as resp:\r\n        release_data = json.loads(resp.read().decode())\r\n\r\n    print(f\"[+] Latest release tag: {release_data.get('tag_name')}\")\r\n\r\n    for asset in release_data.get(\"assets\", []):\r\n        name = asset[\"name\"].lower()\r\n        if (\r\n            name.startswith(\"processor-lite-\")\r\n            and name.endswith(\".apk\")\r\n            and \"canary\" not in name\r\n            and \"devnet\" not in name\r\n        ):\r\n            print(f\"[+] Selected STABLE Lite APK: {asset['name']}\")\r\n            return asset[\"browser_download_url\"], asset[\"name\"]\r\n\r\n    raise RuntimeError(\"Stable processor-lite APK not found in release assets\")\r\n\r\ndef download_apk(url, name):\r\n    temp_path = os.path.join(tempfile.gettempdir(), name)\r\n    print(f\"[*] Downloading {name}\")\r\n    print(f\"[*] Saving to {temp_path}\")\r\n\r\n    # Use the same SSL context for downloading!\r\n    with fetch_url(url, timeout=120) as resp, open(temp_path, \"wb\") as f:\r\n        total = 0\r\n        while True:\r\n            chunk = resp.read(8192)\r\n            if not chunk:\r\n                break\r\n            f.write(chunk)\r\n            total += len(chunk)\r\n            # Progress indicator\r\n            if total % (1024 * 1024) == 0:\r\n                print(f\"[*] Downloaded {total / (1024*1024):.0f} MB...\")\r\n\r\n    size_mb = os.path.getsize(temp_path) / (1024 * 1024)\r\n    print(f\"[+] Download complete ({size_mb:.2f} MB)\")\r\n    return temp_path\r\n\r\ndef install_apk(device, apk_path):\r\n    try:\r\n        print(f\"[{device}] Installing Acurast Lite...\")\r\n        \r\n        cmd = [ADB, \"-s\", device, \"install\", \"-r\", apk_path]\r\n        \r\n        kwargs = {\"capture_output\": True, \"text\": True, \"timeout\": 120}\r\n        if sys.platform == 'win32':\r\n            kwargs[\"creationflags\"] = CREATE_NO_WINDOW\r\n        \r\n        result = subprocess.run(cmd, **kwargs)\r\n\r\n        output = result.stdout + result.stderr\r\n        if \"Success\" in output:\r\n            print(f\"[{device}] ✓ Installed successfully\")\r\n            return f\"[{device}] SUCCESS\"\r\n        elif result.returncode == 0 and \"Failure\" not in output:\r\n            print(f\"[{device}] ✓ Installed (code 0)\")\r\n            return f\"[{device}] SUCCESS\"\r\n        else:\r\n            print(f\"[{device}] ✗ Failed: {output.strip()}\")\r\n            return f\"[{device}] FAILED: {output.strip()}\"\r\n\r\n    except subprocess.TimeoutExpired:\r\n        return f\"[{device}] ERROR: Timeout\"\r\n    except FileNotFoundError:\r\n        return f\"[{device}] ERROR: ADB not found\"\r\n    except Exception as e:\r\n        return f\"[{device}] ERROR: {e}\"\r\n\r\ndef main():\r\n    print(\"=\" * 60)\r\n    print(\"     Acurast Lite - Stable Installer (Production)\")\r\n    print(\"=\" * 60)\r\n\r\n    if not devices:\r\n        print(\"[!] No devices selected\")\r\n        return\r\n\r\n    print(f\"[*] Devices: {len(devices)}\")\r\n    for i, d in enumerate(devices, 1):\r\n        print(f\"  {i}. {d}\")\r\n\r\n    try:\r\n        apk_url, apk_name = get_latest_acurast_lite_apk()\r\n        apk_path = download_apk(apk_url, apk_name)\r\n\r\n        print(\"\\n[*] Installing on devices...\\n\")\r\n\r\n        with ThreadPoolExecutor(max_workers=min(len(devices), 4)) as pool:\r\n            futures = [pool.submit(install_apk, d, apk_path) for d in devices]\r\n            for f in as_completed(futures):\r\n                print(f.result())\r\n\r\n        print(\"\\n[*] Cleaning up...\")\r\n        if os.path.exists(apk_path):\r\n            os.remove(apk_path)\r\n\r\n        print(\"\\n[+] Acurast Lite stable install complete!\")\r\n\r\n    except Exception as e:\r\n        print(f\"[!] Script failed: {e}\")\r\n        import traceback\r\n        traceback.print_exc()\r\n\r\nif __name__ == \"__main__\":\r\n    main()"
}
